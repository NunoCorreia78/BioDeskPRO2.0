<UserControl
    x:Class="BioDesk.App.Views.DashboardView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:converters="clr-namespace:BioDesk.App.Converters"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:viewmodels="clr-namespace:BioDesk.ViewModels;assembly=BioDesk.ViewModels"
    d:DataContext="{d:DesignInstance Type=viewmodels:DashboardViewModel}"
    d:DesignHeight="600"
    d:DesignWidth="800"
    mc:Ignorable="d">

    <UserControl.Resources>
        <!--  Converters  -->
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter" />
        <converters:InverseBooleanToVisibilityConverter x:Key="InverseBooleanToVisibilityConverter" />

        <Style x:Key="ActionButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#9CAF97" />
            <Setter Property="Foreground" Value="White" />
            <Setter Property="FontSize" Value="14" />
            <Setter Property="FontWeight" Value="SemiBold" />
            <Setter Property="Padding" Value="20,12" />
            <Setter Property="BorderBrush" Value="Transparent" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border
                            Padding="{TemplateBinding Padding}"
                            Background="{TemplateBinding Background}"
                            CornerRadius="8">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#879B83" />
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="#6B7F67" />
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Background" Value="#C8D4C5" />
                                <Setter Property="Foreground" Value="#9B9B9B" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="ActionCardStyle" TargetType="Button">
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="BorderBrush" Value="Transparent" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Cursor" Value="Hand" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <ContentPresenter />
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Opacity" Value="0.9" />
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Opacity" Value="0.8" />
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Opacity" Value="0.6" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </UserControl.Resources>

    <Grid>
        <!--  Gradiente de fundo terroso  -->
        <Grid.Background>
            <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                <GradientStop Offset="0" Color="#FCFDFB" />
                <GradientStop Offset="1" Color="#F2F5F0" />
            </LinearGradientBrush>
        </Grid.Background>

        <!--  Espaçamento para conteúdo principal  -->
        <Border
            Height="20"
            VerticalAlignment="Top"
            Background="Transparent" />

        <ScrollViewer Margin="0,20,0,0" VerticalScrollBarVisibility="Auto">
            <Grid Margin="30">
                <StackPanel>
                    <!--  Ações Rápidas Cards Melhorados  -->
                    <TextBlock
                        Margin="0,0,0,20"
                        FontSize="20"
                        FontWeight="SemiBold"
                        Foreground="#3F4A3D"
                        Text="⚡ Ações Rápidas" />

                    <UniformGrid
                        Margin="0,0,0,40"
                        Columns="2"
                        Rows="1">
                        <!--  Card Novo Paciente - Melhorado  -->
                        <Button
                            Margin="0,0,15,0"
                            Command="{Binding NovoPacienteCommand}"
                            Style="{StaticResource ActionCardStyle}"
                            ToolTip="Ctrl+N para criar rapidamente">
                            <Border
                                Padding="30,25"
                                Background="White"
                                BorderBrush="#E3E9DE"
                                BorderThickness="2"
                                CornerRadius="16">
                                <Border.Effect>
                                    <DropShadowEffect
                                        BlurRadius="10"
                                        Opacity="0.4"
                                        ShadowDepth="3"
                                        Color="#E0E0E0" />
                                </Border.Effect>
                                <StackPanel HorizontalAlignment="Center">
                                    <Border
                                        Width="65"
                                        Height="65"
                                        Margin="0,0,0,15"
                                        HorizontalAlignment="Center"
                                        Background="#9CAF97"
                                        CornerRadius="32">
                                        <TextBlock
                                            HorizontalAlignment="Center"
                                            VerticalAlignment="Center"
                                            FontSize="30"
                                            Foreground="White"
                                            Text="👤" />
                                    </Border>
                                    <TextBlock
                                        Margin="0,0,0,5"
                                        HorizontalAlignment="Center"
                                        FontSize="18"
                                        FontWeight="Bold"
                                        Foreground="#3F4A3D"
                                        Text="Novo Paciente" />
                                    <TextBlock
                                        HorizontalAlignment="Center"
                                        FontSize="13"
                                        Foreground="#5A6558"
                                        Text="Criar nova ficha médica" />
                                </StackPanel>
                            </Border>
                        </Button>

                        <!--  Card Lista de Pacientes ✅ FUNCIONAL  -->
                        <Button
                            Margin="15,0,0,0"
                            Command="{Binding ListaPacientesCommand}"
                            Style="{StaticResource ActionCardStyle}"
                            ToolTip="Ctrl+L para abrir lista rapidamente">
                            <Border
                                Padding="30,25"
                                Background="White"
                                BorderBrush="#E3E9DE"
                                BorderThickness="2"
                                CornerRadius="16">
                                <Border.Effect>
                                    <DropShadowEffect
                                        BlurRadius="10"
                                        Opacity="0.3"
                                        ShadowDepth="3"
                                        Color="#E0E0E0" />
                                </Border.Effect>
                                <StackPanel HorizontalAlignment="Center">
                                    <Border
                                        Width="65"
                                        Height="65"
                                        Margin="0,0,0,15"
                                        HorizontalAlignment="Center"
                                        Background="#9CAF97"
                                        CornerRadius="32">
                                        <TextBlock
                                            HorizontalAlignment="Center"
                                            VerticalAlignment="Center"
                                            FontSize="30"
                                            Foreground="White"
                                            Text="📋" />
                                    </Border>
                                    <TextBlock
                                        Margin="0,0,0,5"
                                        HorizontalAlignment="Center"
                                        FontSize="18"
                                        FontWeight="Bold"
                                        Foreground="#3F4A3D"
                                        Text="Lista de Pacientes" />
                                    <TextBlock
                                        HorizontalAlignment="Center"
                                        FontSize="13"
                                        Foreground="#5A6558"
                                        Text="Pesquisar e editar" />
                                </StackPanel>
                            </Border>
                        </Button>
                    </UniformGrid>

                    <!--  Estatísticas Expandidas - LAYOUT 2x2 + CARDS STATUS  -->
                    <Grid Margin="0,0,0,20">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>

                        <TextBlock
                            Grid.Column="0"
                            FontSize="20"
                            FontWeight="SemiBold"
                            Foreground="#3F4A3D"
                            Text="📊 Estatísticas" />

                        <!--  Loading indicator  -->
                        <StackPanel
                            Grid.Column="1"
                            Margin="0,0,10,0"
                            VerticalAlignment="Center"
                            Orientation="Horizontal">
                            <TextBlock
                                Margin="0,0,5,0"
                                FontSize="14"
                                Foreground="#9CAF97"
                                Text="🔄"
                                Visibility="{Binding IsLoadingStats, Converter={StaticResource BooleanToVisibilityConverter}}" />
                            <TextBlock
                                FontSize="11"
                                Foreground="#5A6558"
                                Text="{Binding UltimaAtualizacao, StringFormat='Atualizado: {0:HH:mm:ss}'}"
                                Visibility="{Binding IsLoadingStats, Converter={StaticResource InverseBooleanToVisibilityConverter}}" />
                        </StackPanel>

                        <!--  Botão Configurações  -->
                        <Button
                            Grid.Column="2"
                            Click="BtnConfiguracoes_Click"
                            Content="⚙️ Configurações"
                            Style="{StaticResource ActionButtonStyle}"
                            ToolTip="Configurar email e outras opções do sistema" />
                    </Grid>

                    <!--  LAYOUT DEFINITIVO: 4x2 (8 Cards)  -->
                    <UniformGrid
                        Margin="0,0,0,40"
                        Columns="4"
                        Rows="2">
                        <!--  LINHA 1: SUP ESQ - Total Pacientes  -->
                        <Border
                            Margin="0,0,8,8"
                            Padding="20"
                            Background="White"
                            BorderBrush="#E3E9DE"
                            BorderThickness="2"
                            CornerRadius="12">
                            <Border.Effect>
                                <DropShadowEffect
                                    BlurRadius="6"
                                    Opacity="0.2"
                                    ShadowDepth="2"
                                    Color="#E0E0E0" />
                            </Border.Effect>
                            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                                <TextBlock
                                    Margin="0,0,0,8"
                                    HorizontalAlignment="Center"
                                    FontSize="28"
                                    Text="👥" />
                                <TextBlock
                                    Margin="0,0,0,4"
                                    HorizontalAlignment="Center"
                                    FontSize="32"
                                    FontWeight="Bold"
                                    Foreground="#3F4A3D"
                                    Text="{Binding TotalPacientes}" />
                                <TextBlock
                                    HorizontalAlignment="Center"
                                    FontSize="12"
                                    Foreground="#5A6558"
                                    Text="Total Pacientes" />
                            </StackPanel>
                        </Border>

                        <!--  LINHA 1: SUP CENTRO-ESQ - Consultas Hoje  -->
                        <Border
                            Margin="8,0,8,8"
                            Padding="20"
                            Background="White"
                            BorderBrush="#E3E9DE"
                            BorderThickness="2"
                            CornerRadius="12">
                            <Border.Effect>
                                <DropShadowEffect
                                    BlurRadius="6"
                                    Opacity="0.2"
                                    ShadowDepth="2"
                                    Color="#E0E0E0" />
                            </Border.Effect>
                            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                                <TextBlock
                                    Margin="0,0,0,8"
                                    HorizontalAlignment="Center"
                                    FontSize="28"
                                    Text="📅" />
                                <TextBlock
                                    Margin="0,0,0,4"
                                    HorizontalAlignment="Center"
                                    FontSize="32"
                                    FontWeight="Bold"
                                    Foreground="#3F4A3D"
                                    Text="{Binding ConsultasHoje}" />
                                <TextBlock
                                    HorizontalAlignment="Center"
                                    FontSize="12"
                                    Foreground="#5A6558"
                                    Text="Consultas Hoje" />
                            </StackPanel>
                        </Border>

                        <!--  LINHA 1: SUP CENTRO-DRT - Total Consultas (Semana)  -->
                        <Border
                            Margin="8,0,8,8"
                            Padding="20"
                            Background="White"
                            BorderBrush="#E3E9DE"
                            BorderThickness="2"
                            CornerRadius="12">
                            <Border.Effect>
                                <DropShadowEffect
                                    BlurRadius="6"
                                    Opacity="0.2"
                                    ShadowDepth="2"
                                    Color="#E0E0E0" />
                            </Border.Effect>
                            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                                <TextBlock
                                    Margin="0,0,0,8"
                                    HorizontalAlignment="Center"
                                    FontSize="28"
                                    Text="🗓️" />
                                <TextBlock
                                    Margin="0,0,0,4"
                                    HorizontalAlignment="Center"
                                    FontSize="32"
                                    FontWeight="Bold"
                                    Foreground="#3F4A3D"
                                    Text="{Binding ConsultasSemana}" />
                                <TextBlock
                                    HorizontalAlignment="Center"
                                    FontSize="12"
                                    Foreground="#5A6558"
                                    Text="Total Consultas" />
                            </StackPanel>
                        </Border>

                        <!--  LINHA 1: SUP DRT - Emails Agendados  -->
                        <Border
                            Margin="8,0,0,8"
                            Padding="20"
                            Background="White"
                            BorderBrush="#E3E9DE"
                            BorderThickness="2"
                            CornerRadius="12">
                            <Border.Effect>
                                <DropShadowEffect
                                    BlurRadius="6"
                                    Opacity="0.2"
                                    ShadowDepth="2"
                                    Color="#E0E0E0" />
                            </Border.Effect>
                            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                                <TextBlock
                                    Margin="0,0,0,8"
                                    HorizontalAlignment="Center"
                                    FontSize="28"
                                    Text="📧" />
                                <TextBlock
                                    Margin="0,0,0,4"
                                    HorizontalAlignment="Center"
                                    FontSize="32"
                                    FontWeight="Bold"
                                    Foreground="#3B82F6"
                                    Text="{Binding EmailsAgendados, FallbackValue='0'}" />
                                <TextBlock
                                    HorizontalAlignment="Center"
                                    FontSize="12"
                                    Foreground="#5A6558"
                                    Text="Emails Agendados" />
                            </StackPanel>
                        </Border>

                        <!--  LINHA 2: INF ESQ - Consultas Semana  -->
                        <Border
                            Margin="0,8,8,0"
                            Padding="20"
                            Background="White"
                            BorderBrush="#E3E9DE"
                            BorderThickness="2"
                            CornerRadius="12">
                            <Border.Effect>
                                <DropShadowEffect
                                    BlurRadius="6"
                                    Opacity="0.2"
                                    ShadowDepth="2"
                                    Color="#E0E0E0" />
                            </Border.Effect>
                            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                                <TextBlock
                                    Margin="0,0,0,8"
                                    HorizontalAlignment="Center"
                                    FontSize="28"
                                    Text="📊" />
                                <TextBlock
                                    Margin="0,0,0,4"
                                    HorizontalAlignment="Center"
                                    FontSize="32"
                                    FontWeight="Bold"
                                    Foreground="#3F4A3D"
                                    Text="{Binding ConsultasSemana}" />
                                <TextBlock
                                    HorizontalAlignment="Center"
                                    FontSize="12"
                                    Foreground="#5A6558"
                                    Text="Consultas Semana" />
                            </StackPanel>
                        </Border>

                        <!--  LINHA 2: INF CENTRO-ESQ - Consultas Mês  -->
                        <Border
                            Margin="8,8,8,0"
                            Padding="20"
                            Background="White"
                            BorderBrush="#E3E9DE"
                            BorderThickness="2"
                            CornerRadius="12">
                            <Border.Effect>
                                <DropShadowEffect
                                    BlurRadius="6"
                                    Opacity="0.2"
                                    ShadowDepth="2"
                                    Color="#E0E0E0" />
                            </Border.Effect>
                            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                                <TextBlock
                                    Margin="0,0,0,8"
                                    HorizontalAlignment="Center"
                                    FontSize="28"
                                    Text="📅" />
                                <TextBlock
                                    Margin="0,0,0,4"
                                    HorizontalAlignment="Center"
                                    FontSize="32"
                                    FontWeight="Bold"
                                    Foreground="#3F4A3D"
                                    Text="{Binding ConsultasMes}" />
                                <TextBlock
                                    HorizontalAlignment="Center"
                                    FontSize="12"
                                    Foreground="#5A6558"
                                    Text="Consultas Mês" />
                            </StackPanel>
                        </Border>

                        <!--  LINHA 2: INF CENTRO-DRT - Iridoscópio ON/OFF  -->
                        <Border
                            Margin="8,8,8,0"
                            Padding="20"
                            Background="White"
                            BorderBrush="#E3E9DE"
                            BorderThickness="2"
                            CornerRadius="12">
                            <Border.Effect>
                                <DropShadowEffect
                                    BlurRadius="6"
                                    Opacity="0.2"
                                    ShadowDepth="2"
                                    Color="#E0E0E0" />
                            </Border.Effect>
                            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                                <TextBlock
                                    Margin="0,0,0,8"
                                    HorizontalAlignment="Center"
                                    FontSize="28"
                                    Text="👁️" />
                                <TextBlock
                                    Margin="0,0,0,8"
                                    HorizontalAlignment="Center"
                                    FontSize="14"
                                    FontWeight="SemiBold"
                                    Foreground="#3F4A3D"
                                    Text="Iridoscópio" />
                                <!--  Badge dinâmico baseado em hardware  -->
                                <Border Padding="8,4" CornerRadius="8">
                                    <Border.Style>
                                        <Style TargetType="Border">
                                            <Setter Property="Background" Value="#EF4444" />
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding IridoscopioConectado}" Value="True">
                                                    <Setter Property="Background" Value="#10B981" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Border.Style>
                                    <TextBlock
                                        HorizontalAlignment="Center"
                                        FontSize="11"
                                        FontWeight="Bold"
                                        Foreground="White">
                                        <TextBlock.Style>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="Text" Value="⚠ DESCONECTADO" />
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding IridoscopioConectado}" Value="True">
                                                        <Setter Property="Text" Value="✓ CONECTADO" />
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </TextBlock.Style>
                                    </TextBlock>
                                </Border>
                            </StackPanel>
                        </Border>

                        <!--  LINHA 2: INF DRT - Medicina Quântica ON/OFF  -->
                        <Border
                            Margin="8,8,0,0"
                            Padding="20"
                            Background="White"
                            BorderBrush="#E3E9DE"
                            BorderThickness="2"
                            CornerRadius="12">
                            <Border.Effect>
                                <DropShadowEffect
                                    BlurRadius="6"
                                    Opacity="0.2"
                                    ShadowDepth="2"
                                    Color="#E0E0E0" />
                            </Border.Effect>
                            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                                <TextBlock
                                    Margin="0,0,0,8"
                                    HorizontalAlignment="Center"
                                    FontSize="28"
                                    Text="⚛️" />
                                <TextBlock
                                    Margin="0,0,0,8"
                                    HorizontalAlignment="Center"
                                    FontSize="14"
                                    FontWeight="SemiBold"
                                    Foreground="#3F4A3D"
                                    Text="Med Quântica" />
                                <!--  Badge dinâmico baseado em hardware  -->
                                <Border Padding="8,4" CornerRadius="8">
                                    <Border.Style>
                                        <Style TargetType="Border">
                                            <Setter Property="Background" Value="#EF4444" />
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding MedicinaQuanticaConectada}" Value="True">
                                                    <Setter Property="Background" Value="#10B981" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Border.Style>
                                    <TextBlock
                                        HorizontalAlignment="Center"
                                        FontSize="11"
                                        FontWeight="Bold"
                                        Foreground="White">
                                        <TextBlock.Style>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="Text" Value="⚠ DESCONECTADO" />
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding MedicinaQuanticaConectada}" Value="True">
                                                        <Setter Property="Text" Value="✓ CONECTADO" />
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </TextBlock.Style>
                                    </TextBlock>
                                </Border>
                            </StackPanel>
                        </Border>
                    </UniformGrid>

                    <!--  Card Estado - Sem Título  -->
                    <Border
                        Margin="0,0,0,20"
                        Padding="25"
                        Background="White"
                        BorderBrush="#E3E9DE"
                        BorderThickness="2"
                        CornerRadius="12">
                        <Border.Effect>
                            <DropShadowEffect
                                BlurRadius="8"
                                Opacity="0.3"
                                ShadowDepth="3"
                                Color="#E0E0E0" />
                        </Border.Effect>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>

                            <StackPanel Grid.Column="0">
                                <TextBlock
                                    Margin="0,0,0,3"
                                    FontSize="12"
                                    Foreground="#5A6558"
                                    Text="💻 Sistema:" />
                                <TextBlock
                                    FontSize="12"
                                    FontWeight="SemiBold"
                                    Foreground="#3F4A3D"
                                    Text="BioDeskPro2 v1.0.0" />
                            </StackPanel>

                            <StackPanel Grid.Column="1">
                                <TextBlock
                                    Margin="0,0,0,3"
                                    FontSize="12"
                                    Foreground="#5A6558"
                                    Text="🔄 Última Sincronização:" />
                                <TextBlock
                                    FontSize="12"
                                    FontWeight="SemiBold"
                                    Foreground="#3F4A3D"
                                    Text="{Binding UltimaAtualizacao, StringFormat='dd/MM/yyyy HH:mm:ss'}" />
                            </StackPanel>
                        </Grid>
                    </Border>

                    <!--  Espaçamento final  -->
                    <Border Height="30" />
                </StackPanel>
            </Grid>
        </ScrollViewer>
    </Grid>
</UserControl>
