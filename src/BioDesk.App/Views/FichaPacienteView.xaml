<UserControl x:Class="BioDesk.App.Views.FichaPacienteView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="clr-namespace:BioDesk.ViewModels;assembly=BioDesk.ViewModels"
             mc:Ignorable="d"
             d:DesignHeight="800" d:DesignWidth="1200"
             d:DataContext="{d:DesignInstance Type=vm:FichaPacienteViewModel, IsDesignTimeCreatable=False}">

    <UserControl.Resources>
        <ResourceDictionary>
            <BooleanToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
            
            <LinearGradientBrush x:Key="BackgroundGradient" StartPoint="0,0" EndPoint="0,1">
                <GradientStop Color="#FCFDFB" Offset="0"/>
                <GradientStop Color="#F2F5F0" Offset="1"/>
            </LinearGradientBrush>
            
            <Style x:Key="SectionCard" TargetType="Border">
                <Setter Property="Background" Value="#F7F9F6"/>
                <Setter Property="BorderBrush" Value="#E3E9DE"/>
                <Setter Property="BorderThickness" Value="1"/>
                <Setter Property="CornerRadius" Value="8"/>
                <Setter Property="Padding" Value="20"/>
                <Setter Property="Margin" Value="0,0,0,15"/>
            </Style>
            
            <Style x:Key="SectionTitle" TargetType="TextBlock">
                <Setter Property="FontSize" Value="16"/>
                <Setter Property="FontWeight" Value="SemiBold"/>
                <Setter Property="Foreground" Value="#3F4A3D"/>
                <Setter Property="Margin" Value="0,0,0,15"/>
            </Style>
            
            <Style x:Key="FieldLabel" TargetType="TextBlock">
                <Setter Property="FontWeight" Value="Medium"/>
                <Setter Property="Foreground" Value="#5A6558"/>
                <Setter Property="Margin" Value="0,0,0,5"/>
                <Setter Property="FontSize" Value="12"/>
            </Style>
            
            <Style x:Key="FieldInput" TargetType="TextBox">
                <Setter Property="BorderBrush" Value="#E3E9DE"/>
                <Setter Property="BorderThickness" Value="1"/>
                <Setter Property="Padding" Value="8"/>
                <Setter Property="Margin" Value="0,0,0,15"/>
                <Setter Property="FontSize" Value="13"/>
                <Style.Triggers>
                    <Trigger Property="IsFocused" Value="True">
                        <Setter Property="BorderBrush" Value="#9CAF97"/>
                    </Trigger>
                </Style.Triggers>
            </Style>
            
            <Style x:Key="NaturoTabItem" TargetType="TabItem">
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="TabItem">
                            <Grid>
                                <Border Name="Border" Background="#F7F9F6" BorderBrush="#E3E9DE" 
                                        BorderThickness="1,1,1,0" CornerRadius="8,8,0,0" 
                                        Margin="2,0,2,0" Padding="15,10">
                                    <ContentPresenter ContentSource="Header"/>
                                </Border>
                            </Grid>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsSelected" Value="True">
                                    <Setter TargetName="Border" Property="Background" Value="#9CAF97"/>
                                    <Setter Property="Foreground" Value="White"/>
                                </Trigger>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="Border" Property="Background" Value="#879B83"/>
                                    <Setter Property="Foreground" Value="White"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
        </ResourceDictionary>
    </UserControl.Resources>

    <Grid Background="{StaticResource BackgroundGradient}">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0" Background="#9CAF97" Padding="20,15">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <!-- BotÃ£o Voltar -->
                <Button Grid.Column="0" Content="â† Dashboard" Command="{Binding VoltarCommand}" 
                        Background="Transparent" Foreground="White" BorderThickness="0"
                        Padding="0,0,20,0" FontWeight="Medium" VerticalAlignment="Center"
                        Cursor="Hand"/>
                
                <StackPanel Grid.Column="1">
                    <TextBlock Text="{Binding PacienteAtual.Nome, FallbackValue='Novo Paciente'}" 
                               FontSize="22" FontWeight="Bold" Foreground="White"/>
                    <TextBlock Text="Ficha Completa de Naturopatia" FontSize="14" Foreground="White" Opacity="0.9"/>
                </StackPanel>
                
                <StackPanel Grid.Column="2" Orientation="Horizontal">
                    <TextBlock Text="{Binding PacienteAtual.Idade, StringFormat='Idade: {0} anos'}" 
                               FontSize="14" Foreground="White" Margin="0,0,20,0" VerticalAlignment="Center"/>
                    <TextBlock Text="{Binding PacienteAtual.IMC, StringFormat='IMC: {0:F1}'}" 
                               FontSize="14" Foreground="White" VerticalAlignment="Center"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Main Content com Tabs -->
        <TabControl Grid.Row="1" Background="Transparent" BorderThickness="0" Margin="20">
            
            <!-- Tab 1: Dados Pessoais -->
            <TabItem Header="ðŸ‘¤ Dados Pessoais" Style="{StaticResource NaturoTabItem}">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="10">
                    <StackPanel>
                        
                        <!-- InformaÃ§Ãµes BÃ¡sicas -->
                        <Border Style="{StaticResource SectionCard}">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                
                                <StackPanel Grid.Column="0" Margin="0,0,20,0">
                                    <TextBlock Text="Nome Completo *" Style="{StaticResource FieldLabel}"/>
                                    <TextBox Text="{Binding PacienteAtual.Nome, UpdateSourceTrigger=PropertyChanged}" 
                                             Style="{StaticResource FieldInput}"/>
                                    
                                    <TextBlock Text="Data de Nascimento *" Style="{StaticResource FieldLabel}"/>
                                    <DatePicker SelectedDate="{Binding PacienteAtual.DataNascimento}" 
                                                Margin="0,0,0,15"/>
                                    
                                    <TextBlock Text="Email *" Style="{StaticResource FieldLabel}"/>
                                    <TextBox Text="{Binding PacienteAtual.Email, UpdateSourceTrigger=PropertyChanged}" 
                                             Style="{StaticResource FieldInput}"/>
                                </StackPanel>
                                
                                <StackPanel Grid.Column="1" Margin="10,0,10,0">
                                    <TextBlock Text="Telefone" Style="{StaticResource FieldLabel}"/>
                                    <TextBox Text="{Binding PacienteAtual.Telefone, UpdateSourceTrigger=PropertyChanged}" 
                                             Style="{StaticResource FieldInput}"/>
                                    
                                    <TextBlock Text="ProfissÃ£o" Style="{StaticResource FieldLabel}"/>
                                    <TextBox Text="{Binding PacienteAtual.Profissao, UpdateSourceTrigger=PropertyChanged}" 
                                             Style="{StaticResource FieldInput}"/>
                                    
                                    <TextBlock Text="Estado Civil" Style="{StaticResource FieldLabel}"/>
                                    <TextBox Text="{Binding PacienteAtual.EstadoCivil, UpdateSourceTrigger=PropertyChanged}" 
                                             Style="{StaticResource FieldInput}"/>
                                </StackPanel>
                                
                                <StackPanel Grid.Column="2" Margin="20,0,0,0">
                                    <TextBlock Text="Contacto de EmergÃªncia" Style="{StaticResource FieldLabel}"/>
                                    <TextBox Text="{Binding PacienteAtual.ContatoEmergencia, UpdateSourceTrigger=PropertyChanged}" 
                                             Style="{StaticResource FieldInput}"/>
                                    
                                    <TextBlock Text="Tel. EmergÃªncia" Style="{StaticResource FieldLabel}"/>
                                    <TextBox Text="{Binding PacienteAtual.TelefoneEmergencia, UpdateSourceTrigger=PropertyChanged}" 
                                             Style="{StaticResource FieldInput}"/>
                                </StackPanel>
                            </Grid>
                        </Border>

                        <!-- Morada -->
                        <Border Style="{StaticResource SectionCard}">
                            <StackPanel>
                                <TextBlock Text="Morada Completa" Style="{StaticResource FieldLabel}"/>
                                <TextBox Text="{Binding PacienteAtual.Morada, UpdateSourceTrigger=PropertyChanged}" 
                                         Style="{StaticResource FieldInput}" Height="60" TextWrapping="Wrap" 
                                         AcceptsReturn="True" VerticalScrollBarVisibility="Auto"/>
                            </StackPanel>
                        </Border>
                        
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- Tab 2: Anamnese -->
            <TabItem Header="ðŸ” Anamnese" Style="{StaticResource NaturoTabItem}">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="10">
                    <StackPanel>
                        
                        <!-- HistÃ³rico MÃ©dico -->
                        <Border Style="{StaticResource SectionCard}">
                            <StackPanel>
                                <TextBlock Text="HistÃ³rico MÃ©dico" Style="{StaticResource SectionTitle}"/>
                                
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <StackPanel Grid.Column="0" Margin="0,0,15,0">
                                        <TextBlock Text="HistÃ³rico Familiar" Style="{StaticResource FieldLabel}"/>
                                        <TextBox Text="{Binding PacienteAtual.HistoricoMedicoFamiliar, UpdateSourceTrigger=PropertyChanged}" 
                                                 Style="{StaticResource FieldInput}" Height="80" TextWrapping="Wrap" 
                                                 AcceptsReturn="True" VerticalScrollBarVisibility="Auto"/>
                                        
                                        <TextBlock Text="MedicaÃ§Ã£o Atual" Style="{StaticResource FieldLabel}"/>
                                        <TextBox Text="{Binding PacienteAtual.MedicacaoAtual, UpdateSourceTrigger=PropertyChanged}" 
                                                 Style="{StaticResource FieldInput}" Height="60" TextWrapping="Wrap" 
                                                 AcceptsReturn="True"/>
                                    </StackPanel>
                                    
                                    <StackPanel Grid.Column="1" Margin="15,0,0,0">
                                        <TextBlock Text="HistÃ³rico Pessoal" Style="{StaticResource FieldLabel}"/>
                                        <TextBox Text="{Binding PacienteAtual.HistoricoMedicoPessoal, UpdateSourceTrigger=PropertyChanged}" 
                                                 Style="{StaticResource FieldInput}" Height="80" TextWrapping="Wrap" 
                                                 AcceptsReturn="True" VerticalScrollBarVisibility="Auto"/>
                                        
                                        <TextBlock Text="Suplementos Atuais" Style="{StaticResource FieldLabel}"/>
                                        <TextBox Text="{Binding PacienteAtual.SuplementosAtuais, UpdateSourceTrigger=PropertyChanged}" 
                                                 Style="{StaticResource FieldInput}" Height="60" TextWrapping="Wrap" 
                                                 AcceptsReturn="True"/>
                                    </StackPanel>
                                </Grid>
                            </StackPanel>
                        </Border>
                        
                        <!-- Sintomas e Queixas -->
                        <Border Style="{StaticResource SectionCard}">
                            <StackPanel>
                                <TextBlock Text="Sintomas e Queixas Principais" Style="{StaticResource SectionTitle}"/>
                                
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="2*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <StackPanel Grid.Column="0" Margin="0,0,15,0">
                                        <TextBlock Text="Sintomas Principais" Style="{StaticResource FieldLabel}"/>
                                        <TextBox Text="{Binding PacienteAtual.SintomasPrincipais, UpdateSourceTrigger=PropertyChanged}" 
                                                 Style="{StaticResource FieldInput}" Height="100" TextWrapping="Wrap" 
                                                 AcceptsReturn="True" VerticalScrollBarVisibility="Auto"/>
                                        
                                        <TextBlock Text="Sintomas SecundÃ¡rios" Style="{StaticResource FieldLabel}"/>
                                        <TextBox Text="{Binding PacienteAtual.SintomasSecundarios, UpdateSourceTrigger=PropertyChanged}" 
                                                 Style="{StaticResource FieldInput}" Height="60" TextWrapping="Wrap" 
                                                 AcceptsReturn="True"/>
                                    </StackPanel>
                                    
                                    <StackPanel Grid.Column="1" Margin="15,0,0,0">
                                        <TextBlock Text="Alergias" Style="{StaticResource FieldLabel}"/>
                                        <TextBox Text="{Binding PacienteAtual.Alergias, UpdateSourceTrigger=PropertyChanged}" 
                                                 Style="{StaticResource FieldInput}" Height="60" TextWrapping="Wrap"/>
                                        
                                        <TextBlock Text="IntolerÃ¢ncias" Style="{StaticResource FieldLabel}"/>
                                        <TextBox Text="{Binding PacienteAtual.IntoleranciasAlimentares, UpdateSourceTrigger=PropertyChanged}" 
                                                 Style="{StaticResource FieldInput}" Height="60" TextWrapping="Wrap"/>
                                    </StackPanel>
                                </Grid>
                            </StackPanel>
                        </Border>
                        
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- Tab 3: Estilo de Vida -->
            <TabItem Header="ðŸƒâ€â™‚ï¸ Estilo de Vida" Style="{StaticResource NaturoTabItem}">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="10">
                    <StackPanel>
                        
                        <!-- HÃ¡bitos Alimentares -->
                        <Border Style="{StaticResource SectionCard}">
                            <StackPanel>
                                <TextBlock Text="PadrÃµes Alimentares e HÃ¡bitos" Style="{StaticResource SectionTitle}"/>
                                
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <StackPanel Grid.Column="0" Margin="0,0,15,0">
                                        <TextBlock Text="PadrÃµes Alimentares" Style="{StaticResource FieldLabel}"/>
                                        <TextBox Text="{Binding PacienteAtual.PadroesAlimentares, UpdateSourceTrigger=PropertyChanged}" 
                                                 Style="{StaticResource FieldInput}" Height="80" TextWrapping="Wrap" AcceptsReturn="True"/>
                                        
                                        <TextBlock Text="Consumo de Ãgua (L/dia)" Style="{StaticResource FieldLabel}"/>
                                        <TextBox Text="{Binding PacienteAtual.ConsumoAgua, UpdateSourceTrigger=PropertyChanged}" 
                                                 Style="{StaticResource FieldInput}"/>
                                    </StackPanel>
                                    
                                    <StackPanel Grid.Column="1" Margin="15,0,0,0">
                                        <TextBlock Text="Consumo de Ãlcool" Style="{StaticResource FieldLabel}"/>
                                        <TextBox Text="{Binding PacienteAtual.ConsumoAlcool, UpdateSourceTrigger=PropertyChanged}" 
                                                 Style="{StaticResource FieldInput}"/>
                                        
                                        <CheckBox Content="Fumador" IsChecked="{Binding PacienteAtual.Fumador}" 
                                                  Margin="0,5,0,15" Foreground="#3F4A3D"/>
                                        
                                        <TextBlock Text="Outros HÃ¡bitos" Style="{StaticResource FieldLabel}"/>
                                        <TextBox Text="{Binding PacienteAtual.OutrosHabitos, UpdateSourceTrigger=PropertyChanged}" 
                                                 Style="{StaticResource FieldInput}" Height="60" TextWrapping="Wrap"/>
                                    </StackPanel>
                                </Grid>
                            </StackPanel>
                        </Border>
                        
                        <!-- Sono e Atividade -->
                        <Border Style="{StaticResource SectionCard}">
                            <StackPanel>
                                <TextBlock Text="Sono, Stress e Atividade FÃ­sica" Style="{StaticResource SectionTitle}"/>
                                
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <StackPanel Grid.Column="0" Margin="0,0,15,0">
                                        <TextBlock Text="Qualidade do Sono (1-10)" Style="{StaticResource FieldLabel}"/>
                                        <Slider Value="{Binding PacienteAtual.QualidadeSono}" Minimum="1" Maximum="10" 
                                                TickFrequency="1" IsSnapToTickEnabled="True" TickPlacement="BottomRight" 
                                                Margin="0,0,0,15"/>
                                        
                                        <TextBlock Text="PadrÃ£o de Sono" Style="{StaticResource FieldLabel}"/>
                                        <TextBox Text="{Binding PacienteAtual.PatternSono, UpdateSourceTrigger=PropertyChanged}" 
                                                 Style="{StaticResource FieldInput}" Height="60" TextWrapping="Wrap"/>
                                    </StackPanel>
                                    
                                    <StackPanel Grid.Column="1" Margin="15,0,0,0">
                                        <TextBlock Text="NÃ­vel de Stress (1-10)" Style="{StaticResource FieldLabel}"/>
                                        <Slider Value="{Binding PacienteAtual.NivelStress}" Minimum="1" Maximum="10" 
                                                TickFrequency="1" IsSnapToTickEnabled="True" TickPlacement="BottomRight" 
                                                Margin="0,0,0,15"/>
                                        
                                        <TextBlock Text="Atividade FÃ­sica (1-10)" Style="{StaticResource FieldLabel}"/>
                                        <Slider Value="{Binding PacienteAtual.NivelAtividadeFisica}" Minimum="1" Maximum="10" 
                                                TickFrequency="1" IsSnapToTickEnabled="True" TickPlacement="BottomRight" 
                                                Margin="0,0,0,15"/>
                                        
                                        <TextBlock Text="Tipo de ExercÃ­cio" Style="{StaticResource FieldLabel}"/>
                                        <TextBox Text="{Binding PacienteAtual.TipoExercicio, UpdateSourceTrigger=PropertyChanged}" 
                                                 Style="{StaticResource FieldInput}"/>
                                    </StackPanel>
                                </Grid>
                            </StackPanel>
                        </Border>
                        
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- Tab 4: Exame FÃ­sico -->
            <TabItem Header="ðŸ¦´ Exame FÃ­sico" Style="{StaticResource NaturoTabItem}">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="10">
                    <StackPanel>
                        
                        <!-- Medidas AntropomÃ©tricas -->
                        <Border Style="{StaticResource SectionCard}">
                            <StackPanel>
                                <TextBlock Text="Medidas e Sinais Vitais" Style="{StaticResource SectionTitle}"/>
                                
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <StackPanel Grid.Column="0" Margin="0,0,15,0">
                                        <TextBlock Text="Altura (cm)" Style="{StaticResource FieldLabel}"/>
                                        <TextBox Text="{Binding PacienteAtual.Altura, UpdateSourceTrigger=PropertyChanged}" 
                                                 Style="{StaticResource FieldInput}"/>
                                        
                                        <TextBlock Text="Peso (kg)" Style="{StaticResource FieldLabel}"/>
                                        <TextBox Text="{Binding PacienteAtual.Peso, UpdateSourceTrigger=PropertyChanged}" 
                                                 Style="{StaticResource FieldInput}"/>
                                    </StackPanel>
                                    
                                    <StackPanel Grid.Column="1" Margin="7,0,7,0">
                                        <TextBlock Text="PressÃ£o SistÃ³lica" Style="{StaticResource FieldLabel}"/>
                                        <TextBox Text="{Binding PacienteAtual.PressaoSistolica, UpdateSourceTrigger=PropertyChanged}" 
                                                 Style="{StaticResource FieldInput}"/>
                                        
                                        <TextBlock Text="PressÃ£o DiastÃ³lica" Style="{StaticResource FieldLabel}"/>
                                        <TextBox Text="{Binding PacienteAtual.PressaoDiastolica, UpdateSourceTrigger=PropertyChanged}" 
                                                 Style="{StaticResource FieldInput}"/>
                                    </StackPanel>
                                    
                                    <StackPanel Grid.Column="2" Margin="15,0,0,0">
                                        <TextBlock Text="FrequÃªncia CardÃ­aca" Style="{StaticResource FieldLabel}"/>
                                        <TextBox Text="{Binding PacienteAtual.FrequenciaCardiaca, UpdateSourceTrigger=PropertyChanged}" 
                                                 Style="{StaticResource FieldInput}"/>
                                        
                                        <TextBlock Text="{Binding PacienteAtual.IMC, StringFormat='IMC: {0:F1}'}" 
                                                   FontWeight="SemiBold" Foreground="#9CAF97" FontSize="16"/>
                                    </StackPanel>
                                </Grid>
                            </StackPanel>
                        </Border>
                        
                        <!-- AvaliaÃ§Ã£o Postural -->
                        <Border Style="{StaticResource SectionCard}">
                            <StackPanel>
                                <TextBlock Text="AvaliaÃ§Ã£o Postural e OsteopÃ¡tica" Style="{StaticResource SectionTitle}"/>
                                
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <StackPanel Grid.Column="0" Margin="0,0,15,0">
                                        <TextBlock Text="AvaliaÃ§Ã£o Postural" Style="{StaticResource FieldLabel}"/>
                                        <TextBox Text="{Binding PacienteAtual.AvaliacaoPostural, UpdateSourceTrigger=PropertyChanged}" 
                                                 Style="{StaticResource FieldInput}" Height="80" TextWrapping="Wrap" AcceptsReturn="True"/>
                                        
                                        <TextBlock Text="Pontos de TensÃ£o" Style="{StaticResource FieldLabel}"/>
                                        <TextBox Text="{Binding PacienteAtual.PontosTensao, UpdateSourceTrigger=PropertyChanged}" 
                                                 Style="{StaticResource FieldInput}" Height="60" TextWrapping="Wrap"/>
                                    </StackPanel>
                                    
                                    <StackPanel Grid.Column="1" Margin="15,0,0,0">
                                        <TextBlock Text="Testes OrtopÃ©dicos" Style="{StaticResource FieldLabel}"/>
                                        <TextBox Text="{Binding PacienteAtual.TestesOrtopedicos, UpdateSourceTrigger=PropertyChanged}" 
                                                 Style="{StaticResource FieldInput}" Height="80" TextWrapping="Wrap" AcceptsReturn="True"/>
                                        
                                        <TextBlock Text="Amplitude de Movimento" Style="{StaticResource FieldLabel}"/>
                                        <TextBox Text="{Binding PacienteAtual.AmplitudeMovimento, UpdateSourceTrigger=PropertyChanged}" 
                                                 Style="{StaticResource FieldInput}" Height="60" TextWrapping="Wrap"/>
                                    </StackPanel>
                                </Grid>
                                
                                <TextBlock Text="ObservaÃ§Ãµes do Exame FÃ­sico" Style="{StaticResource FieldLabel}" Margin="0,10,0,5"/>
                                <TextBox Text="{Binding PacienteAtual.ObservacoesExameFisico, UpdateSourceTrigger=PropertyChanged}" 
                                         Style="{StaticResource FieldInput}" Height="80" TextWrapping="Wrap" AcceptsReturn="True"/>
                            </StackPanel>
                        </Border>
                        
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- Tab 5: AvaliaÃ§Ã£o EnergÃ©tica -->
            <TabItem Header="âš¡ Energia" Style="{StaticResource NaturoTabItem}">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="10">
                    <StackPanel>
                        
                        <!-- AvaliaÃ§Ã£o EnergÃ©tica -->
                        <Border Style="{StaticResource SectionCard}">
                            <StackPanel>
                                <TextBlock Text="Medicina QuÃ¢ntica e Estado EnergÃ©tico" Style="{StaticResource SectionTitle}"/>
                                
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <StackPanel Grid.Column="0" Margin="0,0,15,0">
                                        <TextBlock Text="Estado dos Chakras" Style="{StaticResource FieldLabel}"/>
                                        <TextBox Text="{Binding PacienteAtual.AvaliacacaoChakras, UpdateSourceTrigger=PropertyChanged}" 
                                                 Style="{StaticResource FieldInput}" Height="100" TextWrapping="Wrap" AcceptsReturn="True"/>
                                        
                                        <TextBlock Text="Bloqueios EnergÃ©ticos" Style="{StaticResource FieldLabel}"/>
                                        <TextBox Text="{Binding PacienteAtual.BloqueiosEnergeticos, UpdateSourceTrigger=PropertyChanged}" 
                                                 Style="{StaticResource FieldInput}" Height="80" TextWrapping="Wrap" AcceptsReturn="True"/>
                                    </StackPanel>
                                    
                                    <StackPanel Grid.Column="1" Margin="15,0,0,0">
                                        <TextBlock Text="Estado dos Meridianos" Style="{StaticResource FieldLabel}"/>
                                        <TextBox Text="{Binding PacienteAtual.EstadoMeridianos, UpdateSourceTrigger=PropertyChanged}" 
                                                 Style="{StaticResource FieldInput}" Height="100" TextWrapping="Wrap" AcceptsReturn="True"/>
                                        
                                        <TextBlock Text="NÃ­vel de Vitalidade (1-10)" Style="{StaticResource FieldLabel}"/>
                                        <Slider Value="{Binding PacienteAtual.NivelVitalidade}" Minimum="1" Maximum="10" 
                                                TickFrequency="1" IsSnapToTickEnabled="True" TickPlacement="BottomRight" 
                                                Margin="0,0,0,15"/>
                                        
                                        <TextBlock Text="FrequÃªncias Detectadas" Style="{StaticResource FieldLabel}"/>
                                        <TextBox Text="{Binding PacienteAtual.FrequenciasDetectadas, UpdateSourceTrigger=PropertyChanged}" 
                                                 Style="{StaticResource FieldInput}"/>
                                    </StackPanel>
                                </Grid>
                                
                                <TextBlock Text="DiagnÃ³stico EnergÃ©tico" Style="{StaticResource FieldLabel}" Margin="0,10,0,5"/>
                                <TextBox Text="{Binding PacienteAtual.DiagnosticoEnergetico, UpdateSourceTrigger=PropertyChanged}" 
                                         Style="{StaticResource FieldInput}" Height="100" TextWrapping="Wrap" AcceptsReturn="True"/>
                            </StackPanel>
                        </Border>
                        
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- Tab 6: Plano TerapÃªutico -->
            <TabItem Header="ðŸ’Š Tratamento" Style="{StaticResource NaturoTabItem}">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="10">
                    <StackPanel>
                        
                        <!-- Plano de Tratamento -->
                        <Border Style="{StaticResource SectionCard}">
                            <StackPanel>
                                <TextBlock Text="Plano TerapÃªutico Integrado" Style="{StaticResource SectionTitle}"/>
                                
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <StackPanel Grid.Column="0" Margin="0,0,15,0">
                                        <TextBlock Text="Tratamentos OsteopÃ¡ticos" Style="{StaticResource FieldLabel}"/>
                                        <TextBox Text="{Binding PacienteAtual.TratamentosOsteopaticos, UpdateSourceTrigger=PropertyChanged}" 
                                                 Style="{StaticResource FieldInput}" Height="100" TextWrapping="Wrap" AcceptsReturn="True"/>
                                        
                                        <TextBlock Text="SuplementaÃ§Ã£o" Style="{StaticResource FieldLabel}"/>
                                        <TextBox Text="{Binding PacienteAtual.SuplementacaoRecomendada, UpdateSourceTrigger=PropertyChanged}" 
                                                 Style="{StaticResource FieldInput}" Height="80" TextWrapping="Wrap" AcceptsReturn="True"/>
                                        
                                        <TextBlock Text="ExercÃ­cios Recomendados" Style="{StaticResource FieldLabel}"/>
                                        <TextBox Text="{Binding PacienteAtual.ExerciciosRecomendados, UpdateSourceTrigger=PropertyChanged}" 
                                                 Style="{StaticResource FieldInput}" Height="60" TextWrapping="Wrap"/>
                                    </StackPanel>
                                    
                                    <StackPanel Grid.Column="1" Margin="15,0,0,0">
                                        <TextBlock Text="Protocolos NaturopÃ¡ticos" Style="{StaticResource FieldLabel}"/>
                                        <TextBox Text="{Binding PacienteAtual.ProtocolosNaturopaticos, UpdateSourceTrigger=PropertyChanged}" 
                                                 Style="{StaticResource FieldInput}" Height="100" TextWrapping="Wrap" AcceptsReturn="True"/>
                                        
                                        <TextBlock Text="Terapias Complementares" Style="{StaticResource FieldLabel}"/>
                                        <TextBox Text="{Binding PacienteAtual.TerapiasComplementares, UpdateSourceTrigger=PropertyChanged}" 
                                                 Style="{StaticResource FieldInput}" Height="80" TextWrapping="Wrap" AcceptsReturn="True"/>
                                        
                                        <TextBlock Text="PrÃ³xima Consulta" Style="{StaticResource FieldLabel}"/>
                                        <DatePicker SelectedDate="{Binding PacienteAtual.ProximaConsulta}" 
                                                    Margin="0,0,0,15"/>
                                    </StackPanel>
                                </Grid>
                                
                                <TextBlock Text="Objetivos do Tratamento" Style="{StaticResource FieldLabel}" Margin="0,10,0,5"/>
                                <TextBox Text="{Binding PacienteAtual.ObjetivosTratamento, UpdateSourceTrigger=PropertyChanged}" 
                                         Style="{StaticResource FieldInput}" Height="80" TextWrapping="Wrap" AcceptsReturn="True"/>
                            </StackPanel>
                        </Border>
                        
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- Tab 7: EvoluÃ§Ã£o -->
            <TabItem Header="ðŸ“ˆ EvoluÃ§Ã£o" Style="{StaticResource NaturoTabItem}">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="10">
                    <StackPanel>
                        
                        <!-- EvoluÃ§Ã£o do Paciente -->
                        <Border Style="{StaticResource SectionCard}">
                            <StackPanel>
                                <TextBlock Text="Acompanhamento e EvoluÃ§Ã£o" Style="{StaticResource SectionTitle}"/>
                                
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="2*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <StackPanel Grid.Column="0" Margin="0,0,15,0">
                                        <TextBlock Text="Notas das SessÃµes" Style="{StaticResource FieldLabel}"/>
                                        <TextBox Text="{Binding PacienteAtual.NotasSessoes, UpdateSourceTrigger=PropertyChanged}" 
                                                 Style="{StaticResource FieldInput}" Height="150" TextWrapping="Wrap" 
                                                 AcceptsReturn="True" VerticalScrollBarVisibility="Auto"/>
                                        
                                        <TextBlock Text="Progresso dos Sintomas" Style="{StaticResource FieldLabel}"/>
                                        <TextBox Text="{Binding PacienteAtual.ProgressoSintomas, UpdateSourceTrigger=PropertyChanged}" 
                                                 Style="{StaticResource FieldInput}" Height="100" TextWrapping="Wrap" AcceptsReturn="True"/>
                                    </StackPanel>
                                    
                                    <StackPanel Grid.Column="1" Margin="15,0,0,0">
                                        <TextBlock Text="Ãšltima SessÃ£o" Style="{StaticResource FieldLabel}"/>
                                        <DatePicker SelectedDate="{Binding PacienteAtual.UltimaSessao}" 
                                                    Margin="0,0,0,15"/>
                                        
                                        <TextBlock Text="NÂº SessÃµes Realizadas" Style="{StaticResource FieldLabel}"/>
                                        <TextBox Text="{Binding PacienteAtual.NumeroSessoesRealizadas, UpdateSourceTrigger=PropertyChanged}" 
                                                 Style="{StaticResource FieldInput}"/>
                                        
                                        <TextBlock Text="Ajustes no Tratamento" Style="{StaticResource FieldLabel}"/>
                                        <TextBox Text="{Binding PacienteAtual.AjustesTratamento, UpdateSourceTrigger=PropertyChanged}" 
                                                 Style="{StaticResource FieldInput}" Height="80" TextWrapping="Wrap"/>
                                    </StackPanel>
                                </Grid>
                                
                                <TextBlock Text="ObservaÃ§Ãµes Gerais" Style="{StaticResource FieldLabel}" Margin="0,15,0,5"/>
                                <TextBox Text="{Binding PacienteAtual.ObservacoesGerais, UpdateSourceTrigger=PropertyChanged}" 
                                         Style="{StaticResource FieldInput}" Height="100" TextWrapping="Wrap" AcceptsReturn="True"/>
                            </StackPanel>
                        </Border>
                        
                    </StackPanel>
                </ScrollViewer>
            </TabItem>
            
        </TabControl>

        <!-- BotÃµes -->
        <Border Grid.Row="2" Background="White" BorderBrush="#E3E9DE" BorderThickness="0,1,0,0" Padding="20,15">
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                <Button Content="Cancelar" Command="{Binding CancelarCommand}" 
                        Background="#E3E9DE" Foreground="#5A6558" BorderBrush="#E3E9DE"
                        Padding="20,10" Margin="0,0,10,0"/>
                
                <Button Content="Guardar" Command="{Binding SalvarCommand}" 
                        Background="#9CAF97" Foreground="White" BorderBrush="#9CAF97"
                        Padding="20,10"/>
            </StackPanel>
        </Border>

        <!-- Loading overlay -->
        <Border Grid.RowSpan="3" Background="#80FFFFFF" 
                Visibility="{Binding IsLoading, Converter={StaticResource BoolToVisibilityConverter}}">
            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                <ProgressBar IsIndeterminate="True" Width="200" Height="8" 
                           Foreground="#9CAF97" Background="#E3E9DE"/>
                <TextBlock Text="A processar..." 
                         FontSize="14" Foreground="#5A6558" 
                         HorizontalAlignment="Center" 
                         Margin="0,10,0,0"/>
            </StackPanel>
        </Border>

    </Grid>
</UserControl>
