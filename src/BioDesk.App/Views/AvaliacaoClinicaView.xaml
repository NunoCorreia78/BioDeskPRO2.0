<UserControl x:Class="BioDesk.App.Views.AvaliacaoClinicaView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:controls="clr-namespace:BioDesk.App.Controls"
             xmlns:viewmodels="clr-namespace:BioDesk.ViewModels;assembly=BioDesk.ViewModels"
             mc:Ignorable="d" 
             d:DesignHeight="600" d:DesignWidth="900"
             d:DataContext="{d:DesignInstance Type=viewmodels:AvaliacaoClinicaViewModel}">

    <UserControl.Resources>
        <!-- Gradient background do BioDeskPro2 -->
        <LinearGradientBrush x:Key="BackgroundGradient" StartPoint="0,0" EndPoint="0,1">
            <GradientStop Color="#FCFDFB" Offset="0"/>
            <GradientStop Color="#F2F5F0" Offset="1"/>
        </LinearGradientBrush>

        <!-- Estilo para cartÃµes de seÃ§Ã£o -->
        <Style x:Key="SectionCardStyle" TargetType="Border">
            <Setter Property="Background" Value="#F7F9F6"/>
            <Setter Property="BorderBrush" Value="#E3E9DE"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="20"/>
            <Setter Property="Margin" Value="0,0,0,16"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect BlurRadius="4" ShadowDepth="2" Opacity="0.1" Color="#000000"/>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Estilo para tÃ­tulos de seÃ§Ã£o -->
        <Style x:Key="SectionTitleStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="18"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="#3F4A3D"/>
            <Setter Property="Margin" Value="0,0,0,16"/>
        </Style>

        <!-- Estilo para subtÃ­tulos -->
        <Style x:Key="SubtitleStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="Medium"/>
            <Setter Property="Foreground" Value="#3F4A3D"/>
            <Setter Property="Margin" Value="0,12,0,8"/>
        </Style>

        <!-- Estilo para ComboBoxes -->
        <Style x:Key="ModernComboBoxStyle" TargetType="ComboBox">
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderBrush" Value="#E3E9DE"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="8"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Height" Value="32"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
        </Style>

        <!-- Estilo para DatePicker -->
        <Style x:Key="ModernDatePickerStyle" TargetType="DatePicker">
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderBrush" Value="#E3E9DE"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="8"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Height" Value="32"/>
        </Style>

        <!-- Estilo para TextBox de observaÃ§Ãµes -->
        <Style x:Key="ObservationsTextBoxStyle" TargetType="TextBox">
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderBrush" Value="#E3E9DE"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="8"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="MinHeight" Value="60"/>
            <Setter Property="VerticalScrollBarVisibility" Value="Auto"/>
            <Setter Property="TextWrapping" Value="Wrap"/>
            <Setter Property="AcceptsReturn" Value="True"/>
        </Style>

        <!-- Estilo para botÃµes de aÃ§Ã£o -->
        <Style x:Key="ActionButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#9CAF97"/>
            <Setter Property="BorderBrush" Value="#879B83"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Padding" Value="16,8"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Cursor" Value="Hand"/>
        </Style>

        <!-- Estilo para botÃµes secundÃ¡rios -->
        <Style x:Key="SecondaryButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderBrush" Value="#9CAF97"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Foreground" Value="#9CAF97"/>
            <Setter Property="Padding" Value="12,6"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Cursor" Value="Hand"/>
        </Style>
    </UserControl.Resources>

    <Grid Background="{StaticResource BackgroundGradient}">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0" Background="White" BorderBrush="#E3E9DE" BorderThickness="0,0,0,1" Padding="20,16">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0">
                    <TextBlock Text="Tab 2.1 â€” AvaliaÃ§Ã£o ClÃ­nica" 
                               FontSize="24" 
                               FontWeight="SemiBold" 
                               Foreground="#3F4A3D"/>
                    <TextBlock Text="{Binding PacienteNome, StringFormat='Paciente: {0}'}" 
                               FontSize="14" 
                               Foreground="#5A6558" 
                               Margin="0,4,0,0"/>
                </StackPanel>

                <!-- Frases RÃ¡pidas Globais -->
                <controls:QuickPhraseButtons Grid.Column="1" 
                                           Phrases="{Binding FrasesRapidas}"
                                           PhraseClickedCommand="{Binding AplicarFraseRapidaCommand}"
                                           MaxWidth="300"/>
            </Grid>
        </Border>

        <!-- ConteÃºdo Principal com Tabs -->
        <TabControl Grid.Row="1" 
                    SelectedIndex="{Binding TabSelecionada}"
                    Background="Transparent"
                    BorderThickness="0"
                    Margin="20">
            
            <!-- Tab 1: Motivos da Consulta -->
            <TabItem Header="1. Motivos da Consulta">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="0,16,0,0">
                    <Border Style="{StaticResource SectionCardStyle}">
                        <StackPanel>
                            <TextBlock Style="{StaticResource SectionTitleStyle}" Text="Motivos da Consulta"/>

                            <!-- Motivos principais (chips) -->
                            <controls:MultiSelectChips Title="Motivos principais"
                                                     Items="{Binding MotivosDisponiveis}"
                                                     Margin="0,0,0,16"/>

                            <!-- Campo para "Outro" -->
                            <Grid Margin="0,0,0,16">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <TextBlock Grid.Row="0" Style="{StaticResource SubtitleStyle}" Text="Outro motivo (especificar)"/>
                                <TextBox Grid.Row="1" 
                                         Text="{Binding OutroMotivo, UpdateSourceTrigger=PropertyChanged}"
                                         Style="{StaticResource ObservationsTextBoxStyle}"
                                         MinHeight="32"
                                         MaxHeight="60"/>
                            </Grid>

                            <!-- LocalizaÃ§Ã£o e Lado -->
                            <Grid Margin="0,0,0,16">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="16"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                
                                <StackPanel Grid.Column="0">
                                    <TextBlock Style="{StaticResource SubtitleStyle}" Text="LocalizaÃ§Ã£o"/>
                                    <ComboBox ItemsSource="{Binding Localizacoes}"
                                              SelectedItem="{Binding LocalizacaoSelecionada}"
                                              Style="{StaticResource ModernComboBoxStyle}"/>
                                </StackPanel>

                                <StackPanel Grid.Column="2">
                                    <TextBlock Style="{StaticResource SubtitleStyle}" Text="Lado"/>
                                    <ComboBox ItemsSource="{Binding Lados}"
                                              SelectedItem="{Binding LadoSelecionado}"
                                              Style="{StaticResource ModernComboBoxStyle}"/>
                                </StackPanel>
                            </Grid>

                            <!-- CaracterÃ­sticas Temporais -->
                            <Grid Margin="0,0,0,16">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="16"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="16"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <StackPanel Grid.Column="0">
                                    <TextBlock Style="{StaticResource SubtitleStyle}" Text="InÃ­cio (aproximado)"/>
                                    <DatePicker SelectedDate="{Binding DataInicio}"
                                                Style="{StaticResource ModernDatePickerStyle}"/>
                                </StackPanel>

                                <StackPanel Grid.Column="2">
                                    <TextBlock Style="{StaticResource SubtitleStyle}" Text="DuraÃ§Ã£o"/>
                                    <ComboBox ItemsSource="{Binding Duracoes}"
                                              SelectedItem="{Binding DuracaoSelecionada}"
                                              Style="{StaticResource ModernComboBoxStyle}"/>
                                </StackPanel>

                                <StackPanel Grid.Column="4">
                                    <TextBlock Style="{StaticResource SubtitleStyle}" Text="EvoluÃ§Ã£o"/>
                                    <ComboBox ItemsSource="{Binding Evolucoes}"
                                              SelectedItem="{Binding EvolucaoSelecionada}"
                                              Style="{StaticResource ModernComboBoxStyle}"/>
                                </StackPanel>
                            </Grid>

                            <!-- Intensidade (slider) -->
                            <controls:IntensitySlider Title="Intensidade (0-10)"
                                                    Value="{Binding Intensidade}"
                                                    Margin="0,0,0,16"/>

                            <!-- CarÃ¡ter (chips) -->
                            <controls:MultiSelectChips Title="CarÃ¡ter da dor/desconforto"
                                                     Items="{Binding CaracteresDisponiveis}"
                                                     Margin="0,0,0,16"/>

                            <!-- Fatores -->
                            <Grid Margin="0,0,0,16">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="16"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <controls:MultiSelectChips Grid.Column="0"
                                                         Title="Fatores agravantes"
                                                         Items="{Binding FatoresAgravantesDisponiveis}"/>

                                <controls:MultiSelectChips Grid.Column="2"
                                                         Title="Fatores de alÃ­vio"
                                                         Items="{Binding FatoresAlivioDisponiveis}"/>
                            </Grid>

                            <!-- ObservaÃ§Ãµes -->
                            <StackPanel>
                                <TextBlock Style="{StaticResource SubtitleStyle}" Text="ObservaÃ§Ãµes (opcional)"/>
                                <TextBox Text="{Binding MotivoObservacoes, UpdateSourceTrigger=PropertyChanged}"
                                         Style="{StaticResource ObservationsTextBoxStyle}"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>
                </ScrollViewer>
            </TabItem>

            <!-- Tab 2: HistÃ³ria ClÃ­nica -->
            <TabItem Header="2. HistÃ³ria ClÃ­nica">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="0,16,0,0">
                    <Border Style="{StaticResource SectionCardStyle}">
                        <StackPanel>
                            <TextBlock Style="{StaticResource SectionTitleStyle}" Text="HistÃ³ria ClÃ­nica Passada"/>

                            <!-- DoenÃ§as CrÃ³nicas -->
                            <controls:MultiSelectChips Title="DoenÃ§as crÃ³nicas conhecidas"
                                                     Items="{Binding DoencasCronicasDisponiveis}"
                                                     Margin="0,0,0,16"/>

                            <!-- Alergias -->
                            <StackPanel Margin="0,0,0,16">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <controls:MultiSelectChips Grid.Column="0"
                                                             Title="Tipos de alergias"
                                                             Items="{Binding TiposAlergiasDisponiveis}"/>

                                    <CheckBox Grid.Column="1" 
                                              Content="Sem alergias" 
                                              IsChecked="{Binding SemAlergias}"
                                              FontSize="13"
                                              Foreground="#3F4A3D"
                                              VerticalAlignment="Bottom"
                                              Margin="16,0,0,16"/>
                                </Grid>

                                <StackPanel Visibility="{Binding SemAlergias, Converter={StaticResource BooleanToVisibilityConverter}, ConverterParameter=Invert}">
                                    <TextBlock Style="{StaticResource SubtitleStyle}" Text="Especificar alergias"/>
                                    <TextBox Text="{Binding EspecificarAlergias, UpdateSourceTrigger=PropertyChanged}"
                                             Style="{StaticResource ObservationsTextBoxStyle}"
                                             MinHeight="60"/>
                                </StackPanel>
                            </StackPanel>

                            <!-- MedicaÃ§Ã£o Atual -->
                            <StackPanel Margin="0,0,0,16">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <TextBlock Grid.Column="0" Style="{StaticResource SubtitleStyle}" Text="MedicaÃ§Ã£o atual"/>
                                    <CheckBox Grid.Column="1" 
                                              Content="Sem medicaÃ§Ã£o" 
                                              IsChecked="{Binding SemMedicacao}"
                                              FontSize="13"
                                              Foreground="#3F4A3D"
                                              VerticalAlignment="Center"/>
                                </Grid>
                                
                                <!-- Lista de medicaÃ§Ãµes serÃ¡ implementada depois -->
                                <TextBlock Text="(Lista de medicaÃ§Ãµes - a implementar)"
                                           FontStyle="Italic"
                                           Foreground="#5A6558"
                                           Margin="0,8"/>
                            </StackPanel>

                            <!-- SuplementaÃ§Ã£o -->
                            <StackPanel Margin="0,0,0,16">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <TextBlock Grid.Column="0" Style="{StaticResource SubtitleStyle}" Text="SuplementaÃ§Ã£o atual"/>
                                    <CheckBox Grid.Column="1" 
                                              Content="Sem suplementaÃ§Ã£o" 
                                              IsChecked="{Binding SemSuplementacao}"
                                              FontSize="13"
                                              Foreground="#3F4A3D"
                                              VerticalAlignment="Center"/>
                                </Grid>
                                
                                <!-- Lista de suplementos serÃ¡ implementada depois -->
                                <TextBlock Text="(Lista de suplementos - a implementar)"
                                           FontStyle="Italic"
                                           Foreground="#5A6558"
                                           Margin="0,8"/>
                            </StackPanel>

                            <!-- VacinaÃ§Ã£o -->
                            <StackPanel>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <controls:MultiSelectChips Grid.Column="0"
                                                             Title="VacinaÃ§Ã£o relevante"
                                                             Items="{Binding VacinacaoDisponiveis}"/>

                                    <CheckBox Grid.Column="1" 
                                              Content="NÃ£o aplicÃ¡vel" 
                                              IsChecked="{Binding VacinacaoNaoAplicavel}"
                                              FontSize="13"
                                              Foreground="#3F4A3D"
                                              VerticalAlignment="Bottom"
                                              Margin="16,0,0,16"/>
                                </Grid>
                            </StackPanel>
                        </StackPanel>
                    </Border>
                </ScrollViewer>
            </TabItem>

            <!-- Tab 3: RevisÃ£o de Sistemas -->
            <TabItem Header="3. RevisÃ£o de Sistemas">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="0,16,0,0">
                    <Border Style="{StaticResource SectionCardStyle}">
                        <StackPanel>
                            <TextBlock Style="{StaticResource SectionTitleStyle}" Text="RevisÃ£o de Sistemas"/>
                            
                            <TextBlock Text="(Sistemas com sintomas selecionÃ¡veis - implementaÃ§Ã£o em progresso)"
                                       FontStyle="Italic"
                                       Foreground="#5A6558"
                                       Margin="0,0,0,16"/>

                            <!-- Placeholder para sistemas -->
                            <ItemsControl ItemsSource="{Binding Sistemas}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Expander Header="{Binding Key}" 
                                                  Margin="0,0,0,8"
                                                  Background="White"
                                                  BorderBrush="#E3E9DE"
                                                  BorderThickness="1">
                                            <StackPanel Margin="16">
                                                <controls:MultiSelectChips Items="{Binding Value.Sintomas}"
                                                                         Title=""/>
                                                <TextBox Text="{Binding Value.Observacoes, UpdateSourceTrigger=PropertyChanged}"
                                                         Style="{StaticResource ObservationsTextBoxStyle}"
                                                         Margin="0,8,0,0"
                                                         MinHeight="40"/>
                                            </StackPanel>
                                        </Expander>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </StackPanel>
                    </Border>
                </ScrollViewer>
            </TabItem>

            <!-- Tab 4: Estilo de Vida -->
            <TabItem Header="4. Estilo de Vida">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="0,16,0,0">
                    <Border Style="{StaticResource SectionCardStyle}">
                        <StackPanel>
                            <TextBlock Style="{StaticResource SectionTitleStyle}" Text="Estilo de Vida"/>

                            <!-- AlimentaÃ§Ã£o -->
                            <controls:MultiSelectChips Title="PadrÃ£o alimentar"
                                                     Items="{Binding AlimentacaoDisponiveis}"
                                                     Margin="0,0,0,16"/>

                            <!-- HidrataÃ§Ã£o e ExercÃ­cio -->
                            <Grid Margin="0,0,0,16">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="16"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <StackPanel Grid.Column="0">
                                    <TextBlock Style="{StaticResource SubtitleStyle}" Text="HidrataÃ§Ã£o diÃ¡ria"/>
                                    <ComboBox ItemsSource="{Binding Hidratacao}"
                                              SelectedItem="{Binding HidratacaoSelecionada}"
                                              Style="{StaticResource ModernComboBoxStyle}"/>
                                </StackPanel>

                                <StackPanel Grid.Column="2">
                                    <TextBlock Style="{StaticResource SubtitleStyle}" Text="FrequÃªncia de exercÃ­cio"/>
                                    <ComboBox ItemsSource="{Binding FrequenciaExercicio}"
                                              SelectedItem="{Binding ExercicioFrequenciaSelecionada}"
                                              Style="{StaticResource ModernComboBoxStyle}"/>
                                </StackPanel>
                            </Grid>

                            <!-- Tipos de ExercÃ­cio -->
                            <controls:MultiSelectChips Title="Tipos de exercÃ­cio praticados"
                                                     Items="{Binding ExercicioDisponiveis}"
                                                     Margin="0,0,0,16"/>

                            <!-- HÃ¡bitos -->
                            <Grid Margin="0,0,0,16">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="16"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="16"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <StackPanel Grid.Column="0">
                                    <TextBlock Style="{StaticResource SubtitleStyle}" Text="Tabaco"/>
                                    <ComboBox ItemsSource="{Binding Tabaco}"
                                              SelectedItem="{Binding TabacoSelecionado}"
                                              Style="{StaticResource ModernComboBoxStyle}"/>
                                </StackPanel>

                                <StackPanel Grid.Column="2">
                                    <TextBlock Style="{StaticResource SubtitleStyle}" Text="Ãlcool"/>
                                    <ComboBox ItemsSource="{Binding Alcool}"
                                              SelectedItem="{Binding AlcoolSelecionado}"
                                              Style="{StaticResource ModernComboBoxStyle}"/>
                                </StackPanel>

                                <StackPanel Grid.Column="4">
                                    <TextBlock Style="{StaticResource SubtitleStyle}" Text="CafeÃ­na (cafÃ©s/dia)"/>
                                    <ComboBox ItemsSource="{Binding Cafeina}"
                                              SelectedItem="{Binding CafeinaSelecionada}"
                                              Style="{StaticResource ModernComboBoxStyle}"/>
                                </StackPanel>
                            </Grid>

                            <!-- Stress (slider) -->
                            <controls:IntensitySlider Title="NÃ­vel de stress (0-10)"
                                                    Value="{Binding Stress}"
                                                    Margin="0,0,0,16"/>

                            <!-- Problemas de Sono -->
                            <controls:MultiSelectChips Title="Problemas de sono identificados"
                                                     Items="{Binding SonoDisponiveis}"/>
                        </StackPanel>
                    </Border>
                </ScrollViewer>
            </TabItem>

            <!-- Tab 5: HistÃ³ria Familiar -->
            <TabItem Header="5. HistÃ³ria Familiar">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="0,16,0,0">
                    <Border Style="{StaticResource SectionCardStyle}">
                        <StackPanel>
                            <TextBlock Style="{StaticResource SectionTitleStyle}" Text="HistÃ³ria Familiar"/>

                            <!-- Antecedentes familiares -->
                            <controls:MultiSelectChips Title="Antecedentes familiares relevantes"
                                                     Items="{Binding AntecedentesDisponiveis}"
                                                     Margin="0,0,0,16"/>

                            <!-- Grau de parentesco -->
                            <controls:MultiSelectChips Title="Grau de parentesco dos antecedentes"
                                                     Items="{Binding ParentescoDisponiveis}"
                                                     Margin="0,0,0,16"/>

                            <!-- ObservaÃ§Ãµes -->
                            <StackPanel>
                                <TextBlock Style="{StaticResource SubtitleStyle}" Text="ObservaÃ§Ãµes sobre histÃ³ria familiar"/>
                                <TextBox Text="{Binding FamiliarObservacoes, UpdateSourceTrigger=PropertyChanged}"
                                         Style="{StaticResource ObservationsTextBoxStyle}"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>
                </ScrollViewer>
            </TabItem>
        </TabControl>

        <!-- Barra de AÃ§Ãµes -->
        <Border Grid.Row="2" Background="White" BorderBrush="#E3E9DE" BorderThickness="0,1,0,0" Padding="20,16">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Indicador de estado -->
                <StackPanel Grid.Column="0" Orientation="Horizontal">
                    <TextBlock Text="Estado:" 
                               FontSize="13" 
                               Foreground="#5A6558" 
                               VerticalAlignment="Center"/>
                    <Border Background="{Binding IsCompleta, Converter={StaticResource BoolToColorConverter}}"
                            CornerRadius="12"
                            Padding="8,4"
                            Margin="8,0">
                        <TextBlock Text="{Binding IsCompleta, Converter={StaticResource BoolToStatusTextConverter}}"
                                   FontSize="12"
                                   Foreground="White"
                                   FontWeight="SemiBold"/>
                    </Border>
                </StackPanel>

                <!-- BotÃµes de aÃ§Ã£o -->
                <StackPanel Grid.Column="1" Orientation="Horizontal">
                    <Button Style="{StaticResource SecondaryButtonStyle}"
                            Content="Limpar SeÃ§Ã£o"
                            Command="{Binding LimparSecaoCommand}"
                            CommandParameter="{Binding TabSelecionada}"
                            Margin="0,0,12,0"/>
                    
                    <Button Style="{StaticResource ActionButtonStyle}"
                            Content="ðŸ’¾ Salvar AvaliaÃ§Ã£o"
                            Command="{Binding SalvarCommand}"
                            IsEnabled="{Binding IsLoading, Converter={StaticResource BooleanInverseConverter}}"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</UserControl>